---
title: "Exercise 25: Mississippi River Mapping"
subtitle: 'ESS 330 - Quantitative Reasoning'
author:
  - name: "Zachary Cramton"
    url: "https://zachary.cramton.com"
    email: "ZCramton@colostate.edu"

format: html
execute:
  echo: true
---

```{r}
library(dplyr)
library(tidyverse)
library(units)
library(flextable)
library(ggplot2)
library(sf)
library(AOI)
library(USAboundaries)
library(USAboundariesData)

eqdc <- '+proj=eqdc +lat_0=40 +lon_0=-96 +lat_1=20 +lat_2=60 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs'

df <- data.frame(name = state.name, 
                X = state.center$x, 
                Y = state.center$y)
df_sf_gcs <- st_as_sf(df, 
                   coords = c("X", "Y"), 
                   crs = 4269)
states_pcs <- st_transform(df_sf_gcs, 5070)
rivers <- read_sf("../data/assignment_data/majorrivers")
MS_rivers <- rivers %>% 
  filter(SYSTEM == "Mississippi")
MS_rivers <- st_as_sfc(MS_rivers, 
                   coords = c("X", "Y"), 
                   crs = 4269)
conus_states <- setdiff(state.abb, c("AK", "HI"))
  all_counties <- us_counties()
names(all_counties) <- make.unique(names(all_counties))
conus_counties <- all_counties %>%
  filter(!(state_abbr %in% c("AK", "HI")))

# counties intersecting MS river system
mississippi_counties <- st_filter(conus_counties, MS_rivers, .predicate = st_intersects)

# plot
us_mississippi_river_plot <- ggplot() +
  geom_sf(data = conus_counties, fill = "grey90", color = "white") +
  geom_sf(data = mississippi_counties, fill = "lightblue", color = "blue") +
  geom_sf(data = MS_rivers, color = "darkblue") +
  labs(title = "Mississippi River Watershed") +
  theme_minimal()

us_mississippi_river_plot
```